@{
    Layout = "~/Views/Shared/_LayoutDemo.cshtml";
}
@{
    ViewBag.Title = "Data Binding Demo";
}

<style type="text/css">
    #demoHeader label { color: Blue; }

    #demoContent {
        height: 600px;
        overflow: visible;
        position: relative;
        vertical-align: top;
    }

    #demoContent > fieldset { border-radius: 5px; }

    #demoContent fieldset > legend {
        color: Blue;
        font-weight: bold;
    }

    #demoContent .radioItem {
        display: inline-block;
        margin: 4px;
        padding: 4px;
    }

    .stackPanelItem { width: 170px; }

    .stackPanelItem fieldset { border-radius: 5px; }

    .stackPanelItem fieldset legend {
        color: Blue;
        font-weight: bold;
    }
</style>

<script type="text/javascript">
    require(["jriapp", "bindingsDemo"],
        function(RIAPP, DEMO) {
            //create and start application here
            RIAPP.bootstrap.startApp(function() {
                    return new DEMO.DemoApplication(DEMO.appOptions);
                },
                function(app) {
                    //just an example of how to create the data binding in code
                    //store the reference to the Binding's instance - in case we need to destroy it when we want
                    //BUT - even without storing the reference it can not be removed by garbage collector, because it subscribed to property changes
                    //in the TestObject (and TestObject's instance hold references to the subscriber)
                    //P.S.- we really don't need to use data binding here, because we can do the same logic inside the TestObject's code
                    app.UC.createdBinding = app.bind({
                        sourcePath: 'testProperty1',
                        targetPath: 'testProperty2',
                        source: app.testObject,
                        mode: 'OneWay',
                        target: app.testObject,
                        converter: app.getConverter('uppercaseConverter'),
                        converterParam: null
                    });
                });
        });

    $(document).ready(function ($) {
        var $examples = $('script[type="text/x-example"]');
        $examples.each(function (index, el) {
            var $script = $(this);
            var $pre = $("<pre></pre>");
            $pre.text($script.html());
            $script.before($pre);
        });
        $examples.remove();
    });
</script>

<h2 class="ex8">@ViewBag.Title</h2>

<!--using dataform is convenient because it set datacontext scope for all its content-->
<div id="demoContent">
    <fieldset>
        <legend>HTML elements values are binded to the TestObject properties</legend>
        <div style="margin: 5px 5px 5px 0px;">
            <label>testProperty1 to the element view's value property with updateOnKeyUp option: </label>
            <!--without the updateOnKeyUp option, value is updated only when textbox loses the focus-->
            <input type="text" data-bind="{this.value,to=testProperty1,mode=TwoWay,source=testObject}" data-view="options:{updateOnKeyUp=true}" style="width: 250px"/>
            &nbsp;<span data-bind="{this.value,to=testProperty2,source=testObject}"></span>
        </div>
        <div style="margin: 5px 5px 5px 0px;">
            <label>testProperty3 bound using BackWay binding option and without updateOnKeyUp option: </label>
            <input type="text" data-bind="{this.value,to=testProperty3,mode=BackWay,source=testObject}"  style="width: 250px" />
            &nbsp;<span data-bind="{this.value,to=testProperty3,source=testObject}"></span>
        </div>
        <div style="margin: 5px 5px 5px 0px;">
            <label for="months">Months: </label><select size="1" style="width: 150px" data-bind="{this.dataSource,to=months,source=testObject}{this.selectedValue,to=month,mode=TwoWay,source=testObject}" data-view="options:{valuePath=key,textPath=val}"></select>
        </div>
        <div style="margin: 5px 5px 5px 0px;">
            <label for="sends">Formats: </label><select size="1" style="width: 220px" data-bind="{this.dataSource,to=formats,source=testObject}{this.selectedValue,to=format,mode=TwoWay,source=testObject}" data-view="options:{valuePath=key,textPath=val}"></select>
        </div>
    </fieldset>
    <div>
        <h4 style="color:darkgreen;margin-top:2em;">The button uses a default <b>AnchorElView</b>!</h4>
        <script type="text/x-example">
            <a class="btn btn-info btn-small" style="margin: 5px 5px 5px 0px;" data-bind-1="{this.command,to=testCommand,source=testObject}"
              data-bind-2="{this.toolTip,to=testToolTip,source=testObject}">Test command 1</a>
        </script>
        <a class="btn btn-info btn-small" style="margin: 5px 5px 5px 0px;" data-bind-1="{this.command,to=testCommand,source=testObject}"
           data-bind-2="{this.toolTip,to=testToolTip,source=testObject}">Test command 1</a>
    </div>
    <div>
        <h4 style="color:darkblue;margin-top:2em;">The button uses a Generic <b>BaseElView</b> which can be used with any HTML element!</h4>
        <script type="text/x-example">
            <a class="btn btn-info btn-small" style="margin: 5px 5px 5px 0px;min-width:100px; min-height:30px;"
               data-bind-1="{this.events.click,to=testCommand,source=testObject}"
               data-bind-2="{this.toolTip,to=testToolTip,source=testObject}"
               data-bind-3="{this.props.text,to=testProperty1,source=testObject}"
               data-view="name=generic">Test command 2</a>
        </script>
        <a class="btn btn-info btn-small" style="margin: 5px 5px 5px 0px;min-width:100px; min-height:30px;"
           data-bind-1="{this.events.click,to=testCommand,source=testObject}"
           data-bind-2="{this.toolTip,to=testToolTip,source=testObject}"
           data-bind-3="{this.props.text,to=testProperty1,source=testObject}"
           data-view="name=generic">Test command 2</a>
    </div>
    <div>
        <h4 style="color:darkblue;margin-top:2em; display: inline-block;">The source can be an inline object too!</h4>&nbsp;
        <span style="color:darkred;" data-bind="{this.value,to=val,source={val='The databound value have been taken from inline object'}}"></span>
        <script type="text/x-example">
            <span data-bind="{this.value,to=val,source={val='The databound value have been taken from inline object'}}"></span>
        </script>
    </div>
    <div>
        <h4 style="color:darkblue;margin-top:2em; display: inline-block;">Binding the source to the <span style="color:darkred; font-weight:bold;">this</span></h4>&nbsp;
        <script type="text/x-example">
            <div data-bind="{this.text,to=html,source=this,mode=OneTime}"><h3>HTML CONVERTED TO TEXT</h3></div>
        </script>
        <div data-bind="{this.text,to=html,source=this,mode=OneTime}"><h3>HTML CONVERTED TO TEXT</h3></div>
    </div>
    <div style="height:100px; visibility: hidden;">
        it adds extra space to the bottom
    </div>
</div>